{{ define "item_view" }}
{{/* Created on 01. 10. 2024 */}}
{{/* Time-stamp: <2024-10-18 22:18:05 krylon> */}}
{{ $feeds := .Feeds }}
{{ $tags := .Tags }}
{{ range $id, $item := .Items }}
<tr id="tr_item_{{ $id }}">
  <td>{{ fmt_time_minute $item.Timestamp }}</td>
  <td><a href="/feed/{{ $item.FeedID }}">{{ (index $feeds $item.FeedID).Title }}</a></td>
  <td><a href="{{ $item.URL }}">{{ $item.Headline }}</a></td>
  <td id="item_rating_{{ $item.ID }}"> {{/* Rating */}}
    {{ if (eq $item.Rating 0) }}
    {{ if (ne $item.Guessed 0) }}
    {{ if (eq $item.Guessed -1) }}
    <small>(boring)</small>
    {{ else if (eq $item.Guessed 1) }}
    <small>(interesting)</small>
    {{ end }}
    <br />
    {{ end }}
    <button type="button"
            class="btn btn-primary"
            onclick="rate_item({{ $item.ID }}, 1);" >
      Interesting
    </button>
    <button type="button"
            class="btn btn-secondary"
            onclick="rate_item({{ $item.ID }}, -1);" >
      Boring
    </button>
    {{ else if (eq $item.Rating -1) }}
    <img src="/static/face-tired.png" onclick="unrate_item({{ $item.ID }});" />
    {{ else if (eq $item.Rating 1) }}
    <img src="/static/face-glasses.png" onclick="unrate_item({{ $item.ID }});" />
    {{ end }}
  </td>
  <td>
    <div id="item_tags_{{ $item.ID }}">
      {{ range $item.Tags }}
      {{ .Name }}
      {{ end }}
    </div>
    <div id="item_tag_form_{{ $item.ID }}">
      <select id="item_tag_sel_{{ $item.ID }}" class="btn btn-secondary">
        {{ range $idx, $tag := $tags }}
        <option value="{{ $tag.ID }}">{{ $tag.Name }}</option>
        {{ end }}
      </select>
      <button onclick="add_tag({{ $item.ID }});">Add Tag</button>
    </div>
  </td>
  <td>
    {{ if gt (len .Description) 500 }}
    <button class="btn btn-primary"
            data-bs-toggle="collapse"
            href="#collapse_item_{{ .ID }}"
            aria-expanded="false"
            aria-controls="#collapse_item_{{ .ID }}">
      Description
    </button>
    <div class="collapse" id="collapse_item_{{ .ID }}">
      {{ .Description }}
    </div>
    {{ else }}
    {{ .Description }}
    {{ end }}
  </td>
</tr>
{{ end }}
{{ end }}
