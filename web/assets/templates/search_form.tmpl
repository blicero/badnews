{{ define "search_form" }}
{{/* Created on 21. 11. 2024 */}}
{{/* Time-stamp: <2024-11-24 15:42:28 krylon> */}}
<table class="table table-secondary table-striped horizontal">
  <tbody>
    <tr>
      <th>Title</th>
      <td>
        <input type="text" id="search_title" />
        <input type="hidden" id="search_id" value="" />
      </td>
    </tr>
    <tr>
      <th>Tags</th>
      <td>
        <script>
         const tags = {
           {{ range .Tags }}
           "{{ .ID }}": {
             "id": {{ .ID }},
             "name": "{{ .Name }}",
             "parent": {{ .Parent }},
             "level": {{ .Level }},
             "fullname": "{{ .FullName }}",
           },
           {{ end }}
         }

         var search_tags = {}

         function search_tag_add() {
           const sel_id = '#search_tag_select'
           const msg = "search_tag_add() - IMPLEMENTME!!!"
           msg_add(msg)
           console.log(msg)

           const sel = $(sel_id)[0]
           const tag_id = sel.value
           const txt = render_search_tag(tag_id)
           const div = $("#search_tag_list")[0]
           div.innerHTML += txt
           search_tags[tag_id] = true
         } // function search_tag_add()

         function render_search_tag(tag_id) {
           const tag = tags[tag_id]
           const span_id = `search_tag_${tag_id}`

           const txt = `<span id="${span_id}">
           <b>${tag.name}</b>
           <img src="/static/delete.png"
                onclick="remove_search_tag(${tag_id});" />
           </span>`
           return txt
         } // function render_search_tag(tag)

         function remove_search_tag(tag_id) {
           const span_id = `#search_tag_${tag_id}`
           const node = $(span_id)[0]
           node.remove()
           delete(search_tags[tag_id])
         } // function remove_search_tag(span_id)
        </script>
        <div id="search_tag_choice">
          Search for <b>all</b> tags? <input type="checkbox" id="search_tag_all" /><br />
          <select id="search_tag_select" class="btn btn-secondary">
            {{ range $idx, $tag := .Tags }}
            <option value="{{ $tag.ID }}"
                    id="search_tag_opt_{{ $tag.ID }}">
              {{ nbsp (twice $tag.Level) }}{{ $tag.Name }}
            </option>
            {{ end }}
          </select>
          <input type="button"
                 class="btn btn-success"
                 value="Add"
                 onclick="search_tag_add();" />
        </div>
        <div id="search_tag_list">
        </div>
      </td>
    </tr>
    <tr>
      <th>
        Query string
      </th>
      <td>
        <input type="text" id="search_query_string" />
      </td>
    </tr>
  </tbody>
</table>
{{ end }}
